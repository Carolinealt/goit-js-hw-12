{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\n\nconst myApiKey = `21174821-fd3fd6848262c16aee96184b8`;\naxios.defaults.baseURL = `https://pixabay.com/`;\nlet pageGlobal = 0;\nlet requestGlobal = '';\nlet limit = 15;\nlet totalPages = null;\nlet loadMoreBtn = document.querySelector('more-btn');\nlet loader = document.querySelector(`.loader-container`);\nfunction checkContentQuantity(num) {\n  totalPages = Math.ceil(num / limit);\n}\nasync function fetchImg(request) {\n  if (requestGlobal === request) {\n    pageGlobal += 1;\n  } else {\n    pageGlobal = 1;\n  }\n  // pageGlobal = requestGlobal === request ? +1 : 1;\n  const response = await axios.get(`api/`, {\n    params: {\n      key: `${myApiKey}`,\n      q: `${request}`,\n      image_type: `photo`,\n      orientations: `horizontal`,\n      safesearch: true,\n      page: pageGlobal,\n      per_page: limit,\n    },\n  });\n\n  checkContentQuantity(response.data.totalHits);\n  if (response.data.totalHits === 0) {\n    const options = {\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: `#EF4040`,\n      messageColor: 'white',\n      messageSize: `16`,\n      position: 'topRight',\n      messageLineHeight: `88`,\n      class: `ipa`,\n    };\n    iziToast.error(options);\n  }\n  if (pageGlobal > totalPages && response.data.totalHits !== 0) {\n    iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, there are no more posts to load\",\n    });\n    loader.classList.add(`dis-active`);\n    loadMoreBtn.disactive;\n  }\n  requestGlobal = request;\n  return response.data;\n}\n\nexport default fetchImg;\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  descrLoading: document.querySelector('.main-p'),\n  iconLoading: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.more-btn'),\n};\nconst box = new SimpleLightbox('.gallery-link');\n\nconst { gallery, descrLoading, iconLoading, loadMoreBtn } = refs;\n\nfunction createMarkupElement({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-item\">\n <a class=\"gallery-link\" href=\"${largeImageURL}\">  \n\n    <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"image\">\n    </img>\n  </a>\n        <ul class=\"stats-list\">\n            <li class=\"stats-item\">\n                <h3 class=\"stats-header\">Likes</h3>\n                <p class=\"stats-p\">${likes}</p>\n            </li>\n            <li class=\"stats-item\">\n                <h3 class=\"stats-header\">Views</h3>\n                <p class=\"stats-p\">${views}</p>\n            </li>\n            <li class=\"stats-item\">\n                <h3 class=\"stats-header\">Comments</h3>\n                <p class=\"stats-p\">${comments}</p>\n            </li>\n            <li class=\"stats-item\">\n                <h3 class=\"stats-header\">Downloads</h3>\n                <p class=\"stats-p\">${downloads}</p>\n            </li>\n        </ul>\n</li>`;\n}\n\nfunction joinArr(arr) {\n  return arr.join('');\n}\n\nfunction toggleDescr() {\n  descrLoading.classList.toggle('dis-active');\n  iconLoading.classList.toggle('dis-active');\n}\n\nfunction hideLoadBtn() {\n  loadMoreBtn.classList.add(`dis-active`);\n}\n\nfunction showLoadBtn() {\n  loadMoreBtn.classList.remove(`dis-active`);\n}\n\nfunction addDOM(str) {\n  gallery.insertAdjacentHTML('beforeend', str);\n}\n\nfunction addLightBox() {\n  const a = document.querySelectorAll('.gallery-link');\n  a.forEach(element => {\n    element.SimpleLightbox;\n  });\n}\n\nasync function getPromise(prom) {\n  return await prom\n    .then(({ hits }) => {\n      showLoadBtn();\n      toggleDescr();\n      return hits;\n    })\n    .then(hits => {\n      return hits.map(createMarkupElement);\n    })\n    .then(joinArr)\n    .then(addDOM)\n    .then(addLightBox)\n    .then(() => {\n      box.refresh();\n    })\n    .catch(() => {\n      toggleDescr();\n    });\n}\n\nasync function addHTML(prom) {\n  hideLoadBtn();\n  toggleDescr();\n\n  await getPromise(prom);\n}\n\nexport default addHTML;\n","import iziToast from 'izitoast';\nimport fetchImg from './js/pixabay-api';\nimport addHTML from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.main-form'),\n  gallery: document.querySelector('.gallery'),\n  loadMoreBtn: document.querySelector('.more-btn'),\n};\nconst { form, gallery, loadMoreBtn } = refs;\nform.addEventListener('submit', fetchFirstRequest);\n\nfunction fetchFirstRequest(e) {\n  e.preventDefault();\n  gallery.innerHTML = '';\n  const inputValue = e.target.elements.request.value.trim();\n  if (!inputValue) {\n    return;\n  }\n\n  createElements(inputValue);\n  loadMoreBtn.addEventListener('click', fetchMoreRequest);\n}\n\nfunction fetchMoreRequest() {\n  try {\n    createElements(form.elements.request.value);\n  } catch (error) {}\n\n  smothing();\n}\n\nfunction createElements(inputValue) {\n  let cardArray;\n  try {\n    cardArray = fetchImg(inputValue);\n\n    addHTML(cardArray);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function smothing() {\n  let domRect = await gallery.firstChild.getBoundingClientRect();\n  let { height } = domRect;\n  let options = {\n    top: height * 2,\n    left: 0,\n    behavior: `smooth`,\n  };\n  window.scrollBy(options);\n}\n"],"names":["myApiKey","axios","pageGlobal","requestGlobal","limit","totalPages","loadMoreBtn","loader","checkContentQuantity","num","fetchImg","request","response","options","iziToast","refs","box","SimpleLightbox","gallery","descrLoading","iconLoading","createMarkupElement","webformatURL","largeImageURL","tags","likes","views","comments","downloads","joinArr","arr","toggleDescr","hideLoadBtn","showLoadBtn","addDOM","str","addLightBox","element","getPromise","prom","hits","addHTML","form","fetchFirstRequest","inputValue","createElements","fetchMoreRequest","smothing","cardArray","error","domRect","height"],"mappings":"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"}